---
title: "Color_Image"
subtitle: "Pilot Study"
author: "*Masato Terai*"
date: "最終修正: `r Sys.Date()`"
output:
  html_document:
    toc: yes
    toc_depth: 4
    toc_float: yes
    number_sections: yes
    df_print: "paged"
    highlight: "espresso"
---

```{r setup, include=FALSE, tidy=TRUE}
knitr::opts_chunk$set(echo = TRUE)
```

# <span style="color:green">Preprocessing</span>

This is the analysis for Experiment 1. We begin by loading the necessary libraries.

```{r message=FALSE, warning=FALSE, tidy=TRUE}

library(tidyverse)
library(lme4)
library(lmerTest)
library(sjPlot)
library(plotly)
```

```{r,cache=TRUE, tidy=TRUE}
sessionInfo()
```

# <span style="color:green">Data Preparation for Ratings (Words)</span>
## Tydying data

### making the data into long data
```{r,cache=TRUE, results='hide', tidy=TRUE}
setwd("~/Terai_color")

dat <- read.csv("word_typicality_pilot.csv", header = T)

dat %>%
  dplyr::select(c(1, 2, 3, 4)) -> strawberry

dat %>%
  dplyr::select(c(1, 5, 6, 7)) -> bear

dat %>%
  dplyr::select(c(1, 8, 9, 10)) -> chameleon

dat %>%
  dplyr::select(c(1, 11, 12, 13)) -> hair

dat %>%
  dplyr::select(c(1, 14, 15, 16)) -> horse

dat %>%
  dplyr::select(c(1, 17, 18, 19)) -> leaf

dat %>%
  dplyr::select(c(1, 20, 21, 22)) -> tea

dat %>%
  dplyr::select(c(1, 23, 24, 25)) -> steak

dat %>%
  dplyr::select(c(1, 26, 27, 28)) -> tomato

dat %>%
  dplyr::select(c(1, 29, 30, 31)) -> tree

#rbindのために列名をそろえる
strawberry <-cbind(strawberry, type = "strawberry")
colnames(strawberry) <- c("1", "2", "3", "4", "5")
bear <- cbind(bear, type = "bear")
colnames(bear) <- c("1", "2", "3", "4", "5")
chameleon <- cbind(chameleon, type = "chameleon")
colnames(chameleon) <- c("1", "2", "3", "4", "5")
hair <- cbind(hair, type = "hair")
colnames(hair) <- c("1", "2", "3", "4", "5")
horse <- cbind(horse, type = "horse")
colnames(horse) <- c("1", "2", "3", "4", "5")
leaf <- cbind(leaf, type = "leaf")
colnames(leaf) <- c("1", "2", "3", "4", "5")
tea <- cbind(tea, type = "tea")
colnames(tea) <- c("1", "2", "3", "4", "5")
steak <- cbind(steak, type = "steak")
colnames(steak) <- c("1", "2", "3", "4", "5")
tomato <- cbind(tomato, type = "tomato")
colnames(tomato) <- c("1", "2", "3", "4", "5")
tree <- cbind(tree, type = "tree")
colnames(tree) <- c("1", "2", "3", "4", "5")

words <- dplyr::bind_rows(strawberry, bear, chameleon, hair, horse, leaf, tea, 
               steak, tomato, tree)
colnames(words) <- c("ID", "typical", "atypical","unrelated", "word")

ratings <- na.omit(words)
ratings <- as_tibble(ratings) ### Convert to tibble
```

### all responces
```{r,cache=TRUE, tidy=TRUE}
ratings
```

## Check the tendency of responces
```{r,cache=TRUE, tidy=TRUE}
#strawberry
  ratings %>%
    filter(word == "strawberry") -> all_strawberry
  all_strawberry %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_strawberry %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_strawberry %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  strawberry_a <- as.data.frame(length(noftypical$typical)/length(all_strawberry$word)*100)
  #atypicalを選んだ割合
  strawberry_b <- as.data.frame(length(nofatypical$atypical)/length(all_strawberry$word)*100)
  #unrelatedを選んだ割合
  strawberry_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_strawberry$word)*100)
  strawberry_mix <- cbind(word = "strawberry", strawberry_a, strawberry_b, strawberry_c)
  colnames(strawberry_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #bear
  ratings %>%
    filter(word == "bear") -> all_bear
  all_bear %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_bear %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_bear %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  bear_a <- as.data.frame(length(noftypical$typical)/length(all_bear$word)*100)
  #atypicalを選んだ割合
  bear_b <- as.data.frame(length(nofatypical$atypical)/length(all_bear$word)*100)
  #unrelatedを選んだ割合
  bear_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_bear$word)*100)
  bear_mix <- cbind(word = "bear", bear_a, bear_b, bear_c)
  colnames(bear_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #chameleon
  ratings %>%
    filter(word == "chameleon") -> all_chameleon
  all_chameleon %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_chameleon %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_chameleon %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  chameleon_a <- as.data.frame(length(noftypical$typical)/length(all_chameleon$word)*100)
  #atypicalを選んだ割合
  chameleon_b <- as.data.frame(length(nofatypical$atypical)/length(all_chameleon$word)*100)
  #unrelatedを選んだ割合
  chameleon_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_chameleon$word)*100)
  chameleon_mix <- cbind(word = "chameleon", chameleon_a, chameleon_b, chameleon_c)
  colnames(chameleon_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #hair
  ratings %>%
    filter(word == "hair") -> all_hair
  all_hair %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_hair %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_hair %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  hair_a <- as.data.frame(length(noftypical$typical)/length(all_hair$word)*100)
  #atypicalを選んだ割合
  hair_b <- as.data.frame(length(nofatypical$atypical)/length(all_hair$word)*100)
  #unrelatedを選んだ割合
  hair_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_hair$word)*100)
  hair_mix <- cbind(word = "hair", hair_a, hair_b, hair_c)
  colnames(hair_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #horse
  ratings %>%
    filter(word == "horse") -> all_horse
  all_horse %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_horse %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_horse %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  horse_a <- as.data.frame(length(noftypical$typical)/length(all_horse$word)*100)
  #atypicalを選んだ割合
  horse_b <- as.data.frame(length(nofatypical$atypical)/length(all_horse$word)*100)
  #unrelatedを選んだ割合
  horse_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_horse$word)*100)
  horse_mix <- cbind(word = "horse", horse_a, horse_b, horse_c)
  colnames(horse_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #leaf
  ratings %>%
    filter(word == "leaf") -> all_leaf
  all_leaf %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_leaf %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_leaf %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  leaf_a <- as.data.frame(length(noftypical$typical)/length(all_leaf$word)*100)
  #atypicalを選んだ割合
  leaf_b <- as.data.frame(length(nofatypical$atypical)/length(all_leaf$word)*100)
  #unrelatedを選んだ割合
  leaf_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_leaf$word)*100)
  leaf_mix <- cbind(word = "leaf", leaf_a, leaf_b, leaf_c)
  colnames(leaf_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #tea
  ratings %>%
    filter(word == "tea") -> all_tea
  all_tea %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_tea %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_tea %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  tea_a <- as.data.frame(length(noftypical$typical)/length(all_tea$word)*100)
  #atypicalを選んだ割合
  tea_b <- as.data.frame(length(nofatypical$atypical)/length(all_tea$word)*100)
  #unrelatedを選んだ割合
  tea_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_tea$word)*100)
  tea_mix <- cbind(word = "tea", tea_a, tea_b, tea_c)
  colnames(tea_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #steak
  ratings %>%
    filter(word == "steak") -> all_steak
  all_steak %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_steak %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_steak %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  steak_a <- as.data.frame(length(noftypical$typical)/length(all_steak$word)*100)
  #atypicalを選んだ割合
  steak_b <- as.data.frame(length(nofatypical$atypical)/length(all_steak$word)*100)
  #unrelatedを選んだ割合
  steak_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_steak$word)*100)
  steak_mix <- cbind(word = "steak", steak_a, steak_b, steak_c)
  colnames(steak_mix) <- c("word", "typical", "atypical", "unrelated")
  
  
  #tomato
  ratings %>%
    filter(word == "tomato") -> all_tomato
  all_tomato %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_tomato %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_tomato %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  tomato_a <- as.data.frame(length(noftypical$typical)/length(all_tomato$word)*100)
  #atypicalを選んだ割合
  tomato_b <- as.data.frame(length(nofatypical$atypical)/length(all_tomato$word)*100)
  #unrelatedを選んだ割合
  tomato_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_tomato$word)*100)
  tomato_mix <- cbind(word = "tomato", tomato_a, tomato_b, tomato_c)
  colnames(tomato_mix) <- c("word", "typical", "atypical", "unrelated")
  
  #tree
  ratings %>%
    filter(word == "tree") -> all_tree
  all_tree %>%
    select(typical) %>%
    filter(typical == "typical") -> noftypical
  all_tree %>%
    select(atypical) %>%
    filter(atypical == "atypical") -> nofatypical
  all_tree %>%
    select(unrelated) %>%
    filter(unrelated == "unrelated") -> nofunrelated
  #typicalを選んだ割合
  tree_a <- as.data.frame(length(noftypical$typical)/length(all_tree$word)*100)
  #atypicalを選んだ割合
  tree_b <- as.data.frame(length(nofatypical$atypical)/length(all_tree$word)*100)
  #unrelatedを選んだ割合
  tree_c <- as.data.frame(length(nofunrelated$unrelated)/length(all_tree$word)*100)
  tree_mix <- cbind(word = "tree", tree_a, tree_b, tree_c)
  colnames(tree_mix) <- c("word", "typical", "atypical", "unrelated")
  
  all_ratingdata_WORDS <- rbind(strawberry_mix, bear_mix, chameleon_mix,hair_mix, horse_mix,
               leaf_mix, tea_mix, steak_mix, tomato_mix, tree_mix)
  all_ratingdata_WORDS <- as_tibble(all_ratingdata_WORDS) ### Convert to tibble
```

## Summary of Responces
<br>
Participants confirmed that the chosen colors were more typical than atypical equivalents.<br>
However, responses of atypical items seemed complicated. Some items such as "tea" were mostly rated as typical or unrelated.
```{r,cache=TRUE, tidy=TRUE}
  all_ratingdata_WORDS
```




#This completes this analysis.  